---
title: "Untitled"
output:
  pdf_document: default
  html_document: default
classoption: landscape

---

```{r, echo=FALSE, message=FALSE, cache=FALSE, fig.pos="t", warning=FALSE,out.width="75%",fig.align="center", fig.width=14,fig.height=6, out.width='100%'}

library(ggplot2)
library(glmmTMB)
#Read floral visitor data and model output
model_freq_specif_ind <- readRDS("../../Data/RData/model_freq_specif_ind.RData")
pollinator_freq_position_s_ind <- readRDS("../../Data/RData/pollinator_freq_position_s_ind.RData")
#Read plant data and model output
model_freq_specif_ind_plant <- readRDS("../../Data/RData/model_freq_specif_ind_plant.RData")
plant_freq_position_s_ind <- readRDS("../../Data/RData/plant_freq_position_s_ind.RData")

library(visreg)

# Pollinator Model REAL OUTPUTS!!!

pollinators_sp_plot <- visreg(model_freq_specif_ind, "Specificity", by="Group",line.par = list(col = 'black'),
                         strip.names=c("Bee",
                                       "Coleoptera",
                                       "Lepidoptera",
                                       "Non-bee-Hymenoptera",
                                       "Non-syrphids-diptera",
                                       "Syrphids"),gg = TRUE) + theme_bw() +
  xlab("Specialization") + ylab("Partial residuals \n for percentile")+
  scale_x_continuous(breaks = seq(0, 1, by = 0.5))+ scale_fill_grey(start=0.5, end=0.8)

plants_sp_plot <- visreg(model_freq_specif_ind_plant, "Specificity",line.par = list(col = 'black'), by="Group",
       strip.names=c("Selfing herbs",
                     "Small outcrossing perennials",
                     "Self-incompatible perennials\nwith large flowers",
                     "Tall plants with small\nunisexual flowers",
                     "Short-lived outcrossers with\nlong zygomorphic flowers"),gg = TRUE)+ theme_bw() +
  xlab("Specialization") + ylab("Partial residuals \n for percentile")+
  scale_x_continuous(breaks = seq(0, 1, by = 0.5))


library(patchwork)
pollinators_sp_plot/plants_sp_plot & theme(axis.text=element_text(size=10),
        axis.title=element_text(size=14)) & plot_annotation(tag_levels = c('A'),  tag_suffix = ')') &  theme(plot.tag = element_text(size = 22))


```